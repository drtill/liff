<!DOCTYPE HTML>

<html>
	<head>
		<title>CoinPOS Liff App</title>
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>
		<!-- header -->
		<header id="main-header">
		<div class="container">
			<h1><em>CoinPOS Social</em></h1>
		</div>
		</header>

		<section id="showcase">
		<div class="container">
			<h1><em>E-Commerce Platform</em>
			</h1>
		</div>
		</section>

		<section id ="account"><!-- open account section-->
			<div class="title"><b><em>Akun Anda</em></b></div>
			<!---profile (hidden)--->
			<div id="profileInfo" class="hidden">
                <div id="profilePictureDiv">
                </div>
            </div>
            <div id="loginmessage">Hello! Silakan Login Menggunakan akun LINE anda.</div>
            <img id="pictureUrl">
			<!-- LOGIN LOGOUT BUTTONS -->
            <div class="buttonGroup">
                <button id="liffLoginButton">Log in</button>
                <button id="liffLogoutButton">Log out</button>
            </div>
			<!-- Product #1 -->
			<div class="item">
		</section> <!-- close account section-->

		<div id="cart"><!-- open cart-->
			<div class="title"><b><em>Pesanan Anda</em></b></div>
			<div class="image1">
				  <!--img src="img/food.jpg" alt="makanan" /-->
				</div>
			<!-- Product #1 -->
			<div class="item">
				<div class="description">
					<span>Paket Bento A</span>
					<span>Nasi, Ebi Furai</span>
					<span>1 Box</span>
				</div>
				<div class="total-price" id="price1">Rp30.000</div>

				<div class="quantity">
					<button class="quant-btn" id="minus-btn1">-</button>
					<input type="text" value="0" id="foodquantity">
					<button class="quant-btn" id="plus-btn1">+</button>
				</div>
			</div>
			<div class="image2">
				  <!--img src="img/food.jpg" alt="makanan" /-->
				</div>
			<!-- Product #2 -->
			<div class="item">
				<div class="description">
					<span>Ocha</span>
					<span>Teh Jepang</span>
					<span>1 Gelas</span>
				</div>
				<div class="total-price" id="price2">Rp10.000</div>

				<div class="quantity">
					<button class="quant-btn" id = "minus-btn2">-</button>
					<input type="text" name="name" value="0" id="drinkquantity">
					<button class="quant-btn" id = "plus-btn2">+</button>

				</div>
				
			</div>

			<div class="order">
				<button class="order-btn" id="order-btn1">Order</button>
			</div>

		</section> <!-- close cart-->
		<!-- </div> -->
		<footer id="main-footer">
			<div class="container"></div>
			<p>Copyright &copy; 2020 Irfan Budi Satria</p>
			</div>
		</footer>

		<!--Konten LIFF v2-->
 
        <div id="liffAppContent">
            <!-- ACTION BUTTONS -->
            <div class="buttonGroup">
                <div class="buttonRow">
                    <button id="openWindowButton" class="smallbtn">Open External Window</button>
                    <button id="closeWindowButton" class="smallbtn">Close LIFF App</button>
                </div>
 
            </div>
 
            <!-- LIFF DATA -->
            <div id="liffData">
                <table>
                    <tr>
                        <th>isInClient : </th>
                        <td id="isInClient" class="textLeft"></td>
                    </tr>
                    <tr>
                        <th>isLoggedIn : </th>
                        <td id="isLoggedIn" class="textLeft"></td>
                    </tr>
                </table>
            </div>
            
            <div id="statusMessage">
                <div id="isInClientMessage"></div>
            </div>
        </div>
        <!-- LIFF ID ERROR -->
        <div id="liffIdErrorMessage" class="hidden">
            <p>You have not assigned any value for LIFF ID.</p>
            <p>If you are running the app using Node.js, please set the LIFF ID as an environment variable in your
                Heroku account follwing the below steps: </p>
            <code id="code-block">
                <ol>
                    <li>Go to `Dashboard` in your Heroku account.</li>
                    <li>Click on the app you just created.</li>
                    <li>Click on `Settings` and toggle `Reveal Config Vars`.</li>
                    <li>Set `MY_LIFF_ID` as the key and the LIFF ID as the value.</li>
                    <li>Your app should be up and running. Enter the URL of your app in a web browser.</li>
                </ol>
            </code>
            <p>If you are using any other platform, please add your LIFF ID in the <code>index.html</code> file.</p>
            <p>For more information about how to add your LIFF ID, see <a
                    href="https://developers.line.biz/en/reference/liff/#initialize-liff-app">Initializing the LIFF
                    app</a>.</p>
        </div>
        <!-- LIFF INIT ERROR -->
        <div id="liffInitErrorMessage" class="hidden">
            <p>Something went wrong with LIFF initialization.</p>
            <p>LIFF initialization can fail if a user clicks "Cancel" on the "Grant permission" screen, or if an error occurs in the process of <code>liff.init()</code>.
        </div>
        <!-- NODE.JS LIFF ID ERROR -->
        <div id="nodeLiffIdErrorMessage" class="hidden">
            <p>Unable to receive the LIFF ID as an environment variable.</p>
        </div>

		<script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
		<script src="liff-starter.js"></script>
		<script src="main.js"></script>
        <!-- <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script> -->
  <script>
    function createUniversalLink() {
    }

    async function shareMsg() {
    }

    function logOut() {
    }

    function closed() {
    }

    async function scanCode() {
    }

    function openWindow() {
      liff.openWindow({
        url:"https://line.me",
        external:true
      })
    }

    async function getFriendship() {
      const friend = await liff.getFriendship()

      document.getElementById("friendship").append(friend.friendFlag)
      if(!friend.friendFlag)
      {
        if(confirm("you 're not in bot's friend list. Wanna add friend now?"))
        {
          window.location = "https://line.me/R/ti/p/@1653948984"
        }
      }
    }

    async function sendMsg() {
      alert("Message prepare1")
      try
      {
        if(liff.getContext().type !== "none")
        {
          alert("Message prepare2")
          try
          {
            await liff.sendMessages([
            {
              type:"text",
              text:"Hello, World!"
              //stickerid:1,
              //packageid:1

            }])
            alert("Message sent")
          }
          catch(err)
          {
            alert("Error : " + err.message)
          }
          
        }
        else
        {
          alert("Message no sent")
        }
      }
      catch(err)
      {
        alert("Error2 : " + err.message)
      }
      
    }

    function getContext() {
      document.getElementById("type").append(liff.getContext().type)
      document.getElementById("viewType").append(liff.getContext().viewType)
      document.getElementById("utouId").append(liff.getContext().utouId)
      document.getElementById("roomId").append(liff.getContext().roomId)
      document.getElementById("groupId").append(liff.getContext().groupId)
    }

    async function getUserProfile() {
      const profile = await liff.getProfile()

      document.getElementById("pictureUrl").src = profile.pictureUrl
      //document.getElementById("picUrl").append(profile.pictureUrl)
      //document.getElementById("userId").append(profile.userId)
      //document.getElementById("statusMessage").append(profile.statusMessage)
      document.getElementById("loginmessage").append(profile.displayName)

      //document.getElementById("decodedIDToken").append(liff.getDecodedIDToken().email)

    }

    function getEnvironment() {
      document.getElementById("os").append(liff.getOS());

      document.getElementById("language").append(liff.getLanguage());

      document.getElementById("version").append(liff.getVersion());

      document.getElementById("accessToken").append(liff.getAccessToken());

      document.getElementById("isInClient").append(liff.isInClient());

      if(liff.isInClient())
      {
        document.getElementById("btnLogOut").style.display = "none"
      }
      else
      {
        document.getElementById("btnMsg").style.display = "none"
        document.getElementById("btnScanCode").style.display = "none"
        document.getElementById("btnClose").style.display = "none"
      }


    }

    async function main() {
      //alert("LINE Developers x Skooldio")
      await liff.init({ liffId: "1656555843-E6WV7arj" })
      getEnvironment()
      getUserProfile()
      getContext()
      // getFriendship()
      // createUniversalLink()
    }
    main()
  </script>
	</body>

</html>	